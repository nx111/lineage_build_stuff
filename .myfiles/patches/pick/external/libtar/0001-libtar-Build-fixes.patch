From 01cceea5c39b07e6acf6ce1325aecc1b19315ab6 Mon Sep 17 00:00:00 2001
From: Tom Marshall <tdm.code@gmail.com>
Date: Wed, 2 Jan 2019 09:10:49 -0800
Subject: [PATCH] libtar: Build fixes

Change-Id: I3ec8dd7b11f84b7ad56a384219d000202f3e68e6
---
 compat/basename.c | 2 +-
 compat/dirname.c  | 2 +-
 lib/append.c      | 3 +--
 lib/handle.c      | 7 ++++---
 4 files changed, 7 insertions(+), 7 deletions(-)

diff --git a/compat/basename.c b/compat/basename.c
index 32108d6..8f2bf53 100644
--- a/compat/basename.c
+++ b/compat/basename.c
@@ -28,7 +28,7 @@
  */
 
 #ifndef lint
-static char rcsid[] = "$OpenBSD: basename.c,v 1.4 1999/05/30 17:10:30 espie Exp $";
+static char rcsid[] __attribute__((unused)) = "$OpenBSD: basename.c,v 1.4 1999/05/30 17:10:30 espie Exp $";
 #endif /* not lint */
 
 #include <errno.h>
diff --git a/compat/dirname.c b/compat/dirname.c
index 4e06067..85ab9df 100644
--- a/compat/dirname.c
+++ b/compat/dirname.c
@@ -28,7 +28,7 @@
  */
 
 #ifndef lint
-static char rcsid[] = "$OpenBSD: dirname.c,v 1.4 1999/05/30 17:10:30 espie Exp $";
+static char rcsid[] __attribute__((unused)) = "$OpenBSD: dirname.c,v 1.4 1999/05/30 17:10:30 espie Exp $";
 #endif /* not lint */
 
 #include <errno.h>
diff --git a/lib/append.c b/lib/append.c
index ad3c54e..c16ed50 100644
--- a/lib/append.c
+++ b/lib/append.c
@@ -346,8 +346,7 @@ int
 tar_append_buffer(TAR *t, void *buf, size_t len)
 {
 	char block[T_BLOCKSIZE];
-	int filefd;
-	int i, j;
+	int i;
 	size_t size;
 
 	size = len;
diff --git a/lib/handle.c b/lib/handle.c
index 002d23c..822827b 100644
--- a/lib/handle.c
+++ b/lib/handle.c
@@ -32,7 +32,7 @@ static tartype_t default_type = { open, close, read, write };
 
 static int
 tar_init(TAR **t, const char *pathname, tartype_t *type,
-	 int oflags, int mode, int options)
+	 int oflags, int options)
 {
 	if ((oflags & O_ACCMODE) == O_RDWR)
 	{
@@ -69,7 +69,7 @@ int
 tar_open(TAR **t, const char *pathname, tartype_t *type,
 	 int oflags, int mode, int options)
 {
-	if (tar_init(t, pathname, type, oflags, mode, options) == -1)
+	if (tar_init(t, pathname, type, oflags, options) == -1)
 		return -1;
 
 	if ((options & TAR_NOOVERWRITE) && (oflags & O_CREAT))
@@ -95,7 +95,8 @@ int
 tar_fdopen(TAR **t, int fd, const char *pathname, tartype_t *type,
 	   int oflags, int mode, int options)
 {
-	if (tar_init(t, pathname, type, oflags, mode, options) == -1)
+	(void)mode;
+	if (tar_init(t, pathname, type, oflags, options) == -1)
 		return -1;
 
 	(*t)->fd = fd;
-- 
2.17.1

