From 6f48e018735fa3b8b14e52cd7f1d9989e4757ead Mon Sep 17 00:00:00 2001
From: Tom Marshall <tdm.code@gmail.com>
Date: Tue, 6 Mar 2018 21:48:56 +0100
Subject: [PATCH 38/44] recovery: Allow device specific backlight path

Change-Id: I4a2944d32df35c60892c0f7aca046ca862913ee5
---
 Android.mk | 6 ++++++
 ui.cpp     | 4 ++--
 2 files changed, 8 insertions(+), 2 deletions(-)

diff --git a/Android.mk b/Android.mk
index f66860b1..47696190 100644
--- a/Android.mk
+++ b/Android.mk
@@ -148,6 +148,12 @@ else
 LOCAL_CFLAGS += -DRECOVERY_UI_VR_STEREO_OFFSET=0
 endif
 
+ifneq ($(TARGET_RECOVERY_BACKLIGHT_PATH),)
+LOCAL_CFLAGS += -DBACKLIGHT_PATH=\"$(TARGET_RECOVERY_BACKLIGHT_PATH)\"
+else
+LOCAL_CFLAGS += -DBACKLIGHT_PATH=\"/sys/class/leds/lcd-backlight\"
+endif
+
 LOCAL_C_INCLUDES += \
     system/vold \
 
diff --git a/ui.cpp b/ui.cpp
index 99fa7f40..7526864a 100644
--- a/ui.cpp
+++ b/ui.cpp
@@ -49,8 +49,8 @@
 #include "device.h"
 
 static constexpr int UI_WAIT_KEY_TIMEOUT_SEC = 120;
-static constexpr const char* BRIGHTNESS_FILE = "/sys/class/leds/lcd-backlight/brightness";
-static constexpr const char* MAX_BRIGHTNESS_FILE = "/sys/class/leds/lcd-backlight/max_brightness";
+static constexpr const char* BRIGHTNESS_FILE = BACKLIGHT_PATH "/brightness";
+static constexpr const char* MAX_BRIGHTNESS_FILE = BACKLIGHT_PATH "/max_brightness";
 static constexpr const char* BRIGHTNESS_FILE_SDM =
     "/sys/class/backlight/panel0-backlight/brightness";
 static constexpr const char* MAX_BRIGHTNESS_FILE_SDM =
-- 
2.17.1

