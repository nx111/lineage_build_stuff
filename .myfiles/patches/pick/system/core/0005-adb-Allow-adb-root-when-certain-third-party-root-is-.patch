From 086d82d80f3113f3d5a1a79fe363ab2079e471a5 Mon Sep 17 00:00:00 2001
From: Michael Bestas <mkbestas@lineageos.org>
Date: Sun, 17 Feb 2019 01:56:15 +0200
Subject: [PATCH 5/7] adb: Allow adb root when certain third party root is
 present

Change-Id: I802ad32176c4fecaf52d1ab64929a17bf9e5f9bb
---
 adb/adb_utils.cpp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/adb/adb_utils.cpp b/adb/adb_utils.cpp
index 043287c56..f755f1e0c 100644
--- a/adb/adb_utils.cpp
+++ b/adb/adb_utils.cpp
@@ -331,6 +331,6 @@ bool allow_adb_root() {
     if ((root_access & 2) != 2) {
         return false;
     }
-    return __android_log_is_debuggable();
+    return __android_log_is_debuggable() || access("/sbin/su", F_OK) == 0;
 }
 #endif
-- 
2.17.1

