From d2ef36b5a81cd0bed085bf39e60e4f713c530ae5 Mon Sep 17 00:00:00 2001
From: Shivaprasad Hongal <shongal@codeaurora.org>
Date: Thu, 12 Jul 2018 16:24:45 -0700
Subject: [PATCH 01/11] fs_mgr: Wrapped key support for FBE

Add "ice_wrapped_key_supported" support to be read from
fstab.

CRs-Fixed: 2288316

Change-Id: I01f634e8d464059791d731d2af690bdfd8008107
---
 fs_mgr/fs_mgr_fstab.cpp | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/fs_mgr/fs_mgr_fstab.cpp b/fs_mgr/fs_mgr_fstab.cpp
index b77974396..23e32b402 100644
--- a/fs_mgr/fs_mgr_fstab.cpp
+++ b/fs_mgr/fs_mgr_fstab.cpp
@@ -114,11 +114,13 @@ static struct flag_list fs_mgr_flags[] = {
 #define EM_ICE          2
 #define EM_AES_256_CTS  3
 #define EM_AES_256_HEH  4
+#define EM_ICE_WRAPPED_KEY_SUPPORTED 7
 
 static const struct flag_list file_contents_encryption_modes[] = {
     {"aes-256-xts", EM_AES_256_XTS},
     {"software", EM_AES_256_XTS}, /* alias for backwards compatibility */
     {"ice", EM_ICE}, /* hardware-specific inline cryptographic engine */
+    {"ice_wrapped_key_supported", EM_ICE_WRAPPED_KEY_SUPPORTED}, /* ICE engine with wrapped key support */
     {0, 0},
 };
 
-- 
2.17.1

