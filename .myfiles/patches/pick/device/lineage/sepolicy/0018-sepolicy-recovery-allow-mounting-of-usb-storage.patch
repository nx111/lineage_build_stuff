From 4c82cb91683136139d6d13abc4e83450ccda54c0 Mon Sep 17 00:00:00 2001
From: Alessandro Astone <ales.astone@gmail.com>
Date: Fri, 29 Mar 2019 18:10:57 +0100
Subject: [PATCH 18/20] sepolicy: recovery: allow mounting of usb storage

Change-Id: Ide51c085b1e697044e1fbb00eab6fa7d78cb9ff0
---
 common/private/recovery.te | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/common/private/recovery.te b/common/private/recovery.te
index 07ef34b..8af273d 100644
--- a/common/private/recovery.te
+++ b/common/private/recovery.te
@@ -32,6 +32,8 @@ domain_trans(recovery, otapreopt_chroot_exec, backuptool)
 
 # Volume manager
 allow recovery block_device:dir create_dir_perms;
+allow recovery block_device:blk_file { create rw_file_perms };
+allow recovery self:capability mknod;
 allow recovery proc_filesystems:file r_file_perms;
 allow recovery self:netlink_kobject_uevent_socket create_socket_perms_no_ioctl;
 
-- 
2.17.1

