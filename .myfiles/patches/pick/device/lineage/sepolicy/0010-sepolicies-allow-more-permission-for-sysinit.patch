From da7991473dc7a32899a88ee1d8f342035a0839d9 Mon Sep 17 00:00:00 2001
From: nx111 <NX111.AimH@gmail.com>
Date: Sun, 10 Feb 2019 14:53:19 +0800
Subject: [PATCH 10/10] sepolicies: allow more permission for sysinit.

Change-Id: I13e9bcd9637dbdaa6337d74ec64288b1ca813d4b
---
 common/private/sysinit.te | 24 ++++++++++++++++++++++++
 1 file changed, 24 insertions(+)

diff --git a/common/private/sysinit.te b/common/private/sysinit.te
index 7a584d5..0abba06 100644
--- a/common/private/sysinit.te
+++ b/common/private/sysinit.te
@@ -8,3 +8,27 @@ neverallow { domain -init } sysinit:process transition;
 userdebug_or_eng(`
     permissive sysinit;
 ')
+
+allow sysinit shell_exec:file {
+    execute
+    getattr
+    read
+    open
+};
+
+allow sysinit toolbox_exec:file {
+    execute
+    getattr
+    read
+    open
+    execute_no_trans
+};
+
+allow sysinit system_file:dir {
+    read
+    open
+};
+
+allow sysinit system_file:file {
+    execute_no_trans
+};
-- 
2.17.1

