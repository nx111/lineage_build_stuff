From 7b87da829beed7cedf628b27f346857c9638a62a Mon Sep 17 00:00:00 2001
From: Michael Bestas <mkbestas@lineageos.org>
Date: Mon, 11 Feb 2019 18:25:36 +0200
Subject: [PATCH 04/15] Move snap/gallery definitions back to private

* Nothing needs to access them

Change-Id: Iec377a8e1b78477865146649c84fad7247ca8eae
---
 common/private/gallery_app.te | 5 +++--
 common/private/snap_app.te    | 5 +++--
 common/public/gallery_app.te  | 1 -
 common/public/snap_app.te     | 1 -
 4 files changed, 6 insertions(+), 6 deletions(-)
 delete mode 100644 common/public/gallery_app.te
 delete mode 100644 common/public/snap_app.te

diff --git a/common/private/gallery_app.te b/common/private/gallery_app.te
index f2caa77..436e93f 100644
--- a/common/private/gallery_app.te
+++ b/common/private/gallery_app.te
@@ -1,8 +1,8 @@
+type gallery_app, domain, coredomain;
+
 app_domain(gallery_app)
 net_domain(gallery_app)
 
-typeattribute gallery_app system_executes_vendor_violators;
-
 # Access standard system services
 allow gallery_app app_api_service:service_manager find;
 allow gallery_app audioserver_service:service_manager find;
@@ -18,4 +18,5 @@ allow gallery_app surfaceflinger_service:service_manager find;
 allow gallery_app hidl_token_hwservice:hwservice_manager find;
 
 # Allow to read and execute camera app modules
+typeattribute gallery_app system_executes_vendor_violators;
 allow gallery_app vendor_file:file { rx_file_perms };
diff --git a/common/private/snap_app.te b/common/private/snap_app.te
index 586b619..2568d06 100644
--- a/common/private/snap_app.te
+++ b/common/private/snap_app.te
@@ -1,8 +1,8 @@
+type snap_app, domain, coredomain;
+
 app_domain(snap_app)
 net_domain(snap_app)
 
-typeattribute snap_app system_executes_vendor_violators;
-
 # Access standard system services
 allow snap_app app_api_service:service_manager find;
 allow snap_app audioserver_service:service_manager find;
@@ -18,6 +18,7 @@ allow snap_app surfaceflinger_service:service_manager find;
 allow snap_app hidl_token_hwservice:hwservice_manager find;
 
 # Allow to read and execute camera app modules
+typeattribute snap_app system_executes_vendor_violators;
 allow snap_app vendor_file:file { rx_file_perms };
 
 # Execute libraries from RenderScript cache
diff --git a/common/public/gallery_app.te b/common/public/gallery_app.te
deleted file mode 100644
index 9293c30..0000000
--- a/common/public/gallery_app.te
+++ /dev/null
@@ -1 +0,0 @@
-type gallery_app, domain, coredomain;
diff --git a/common/public/snap_app.te b/common/public/snap_app.te
deleted file mode 100644
index 5843d47..0000000
--- a/common/public/snap_app.te
+++ /dev/null
@@ -1 +0,0 @@
-type snap_app, domain, coredomain;
-- 
2.17.1

