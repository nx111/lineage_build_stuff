From 4330d7f9cba5b731b6f976535eebde59662c22a1 Mon Sep 17 00:00:00 2001
From: Alessandro Astone <ales.astone@gmail.com>
Date: Fri, 29 Mar 2019 22:45:23 +0100
Subject: [PATCH 19/20] sepolicy: recovery: allow reading fbe key version

 * We use this to detect fbe encryption

Change-Id: I29355790068b78437aba11390bdf3efd22e229bc
---
 common/private/recovery.te | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/common/private/recovery.te b/common/private/recovery.te
index 8af273d..fb8d6e6 100644
--- a/common/private/recovery.te
+++ b/common/private/recovery.te
@@ -45,4 +45,7 @@ allow recovery tmpfs:file link;
 
 # Read battery percentage
 allow recovery sysfs_batteryinfo:dir search;
+
+# Read fbe encryption info
+r_dir_file(recovery, unencrypted_data_file)
 ')
-- 
2.17.1

