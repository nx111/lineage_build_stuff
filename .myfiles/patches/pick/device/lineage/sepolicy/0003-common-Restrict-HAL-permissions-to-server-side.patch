From 5ecccedfcb8dd5a5c3d87b173db3bb1d05e2c436 Mon Sep 17 00:00:00 2001
From: dianlujitao <dianlujitao@lineageos.org>
Date: Wed, 20 Feb 2019 10:37:47 +0800
Subject: [PATCH 03/14] common: Restrict HAL permissions to server side

 * Obviously HAL clients don't write sysfs.

Change-Id: I8b6a3cad3b1c4c8bddc27364b64ec7164871143b
---
 common/public/hal_lineage_livedisplay.te | 2 +-
 common/public/hal_lineage_trust.te       | 4 ++--
 2 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/common/public/hal_lineage_livedisplay.te b/common/public/hal_lineage_livedisplay.te
index 938b3ee..f0e7a07 100644
--- a/common/public/hal_lineage_livedisplay.te
+++ b/common/public/hal_lineage_livedisplay.te
@@ -5,4 +5,4 @@ add_hwservice(hal_lineage_livedisplay_server, hal_lineage_livedisplay_hwservice)
 allow hal_lineage_livedisplay_client hal_lineage_livedisplay_hwservice:hwservice_manager find;
 
 # Grant access over LiveDisplay tuneables
-allow hal_lineage_livedisplay sysfs_livedisplay_tuneable:file rw_file_perms;
+allow hal_lineage_livedisplay_server sysfs_livedisplay_tuneable:file rw_file_perms;
diff --git a/common/public/hal_lineage_trust.te b/common/public/hal_lineage_trust.te
index 2c695d2..ca4eff4 100644
--- a/common/public/hal_lineage_trust.te
+++ b/common/public/hal_lineage_trust.te
@@ -4,6 +4,6 @@ binder_call(hal_lineage_trust_client, hal_lineage_trust_server)
 add_hwservice(hal_lineage_trust_server, hal_lineage_trust_hwservice)
 allow hal_lineage_trust_client hal_lineage_trust_hwservice:hwservice_manager find;
 
-allow hal_lineage_trust self:capability sys_admin;
+allow hal_lineage_trust_server self:capability sys_admin;
 
-allow hal_lineage_trust proc_deny_new_usb:file rw_file_perms;
+allow hal_lineage_trust_server proc_deny_new_usb:file rw_file_perms;
-- 
2.17.1

