From 9136d45d1d1bdcff976680ed68923f60eee46b45 Mon Sep 17 00:00:00 2001
From: Nolen Johnson <johnsonnolen@gmail.com>
Date: Mon, 25 Mar 2019 03:30:24 +0000
Subject: [PATCH 9/9] sepolicy: Allow the QCOM Boot Control HAL needed
 permissions

Change-Id: I78c691e65006bc5ac734eb39048dccf2d381abac
---
 vendor/common/hal_bootctl.te | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/vendor/common/hal_bootctl.te b/vendor/common/hal_bootctl.te
index ee576ddd..6fde6193 100644
--- a/vendor/common/hal_bootctl.te
+++ b/vendor/common/hal_bootctl.te
@@ -60,3 +60,10 @@ dontaudit hal_bootctl self:capability sys_rawio;
 
 # Allow boot_control_hal to write to the XBL devices.
 allow hal_bootctl xbl_block_device:blk_file rw_file_perms;
+
+# Allow boot_control_hal to read SCSI devices.
+allow hal_bootctl_default sysfs_scsi_devices_other:dir r_dir_perms;
+
+# Allow boot_control_hal sys_admin.
+allow hal_bootctl_default self:capability sys_admin;
+
-- 
2.17.1

