From 75032bde2909c1b5ebe9853572dd391e23b52d81 Mon Sep 17 00:00:00 2001
From: Bruno Martins <bgcngm@gmail.com>
Date: Thu, 7 Mar 2019 23:02:44 +0000
Subject: [PATCH 6/6] common: Add rules for NXP ESE service

Change-Id: I3c618e781f3a03ae9c84ac9a0bbbe0984ac7cd3a
---
 vendor/common/hal_secure_element_default.te | 4 +++-
 vendor/common/hwservice.te                  | 1 +
 vendor/common/hwservice_contexts            | 1 +
 3 files changed, 5 insertions(+), 1 deletion(-)

diff --git a/vendor/common/hal_secure_element_default.te b/vendor/common/hal_secure_element_default.te
index 36f6e970..fb29fb65 100644
--- a/vendor/common/hal_secure_element_default.te
+++ b/vendor/common/hal_secure_element_default.te
@@ -29,4 +29,6 @@
 hal_client_domain(hal_secure_element_default, hal_esepowermanager)
 
 #Allow access to the qteeconnector
-hal_client_domain(hal_secure_element_default, hal_qteeconnector)
\ No newline at end of file
+hal_client_domain(hal_secure_element_default, hal_qteeconnector)
+
+allow hal_secure_element_default nxpese_hwservice:hwservice_manager { add };
diff --git a/vendor/common/hwservice.te b/vendor/common/hwservice.te
index 507ca04d..0f14a000 100644
--- a/vendor/common/hwservice.te
+++ b/vendor/common/hwservice.te
@@ -59,3 +59,4 @@ type hal_wifilearner_hwservice, hwservice_manager_type;
 type hal_seccam_hwservice, hwservice_manager_type;
 type hal_cvp_hwservice, hwservice_manager_type;
 type hal_cne_hwservice, hwservice_manager_type;
+type nxpese_hwservice, hwservice_manager_type;
diff --git a/vendor/common/hwservice_contexts b/vendor/common/hwservice_contexts
index 7406f043..a15ef1bc 100644
--- a/vendor/common/hwservice_contexts
+++ b/vendor/common/hwservice_contexts
@@ -41,6 +41,7 @@ vendor.display.config::IDisplayConfig                        u:object_r:hal_disp
 vendor.display.postproc::IDisplayPostproc                    u:object_r:hal_display_postproc_hwservice:s0
 vendor.qti.gnss::ILocHidlGnss                                u:object_r:hal_gnss_hwservice:s0
 vendor.nxp.hardware.nfc::INqNfc                              u:object_r:hal_nfc_hwservice:s0
+vendor.nxp.nxpese::INxpEse                                   u:object_r:nxpese_hwservice:s0
 vendor.qti.hardware.improvetouch.touchcompanion::ITouchCompanion       u:object_r:hal_hbtp_hwservice:s0
 vendor.qti.hardware.improvetouch.gesturemanager::IGestureManager       u:object_r:hal_hbtp_hwservice:s0
 vendor.qti.hardware.improvetouch.blobmanager::IBlobManager             u:object_r:hal_hbtp_hwservice:s0
-- 
2.17.1

