From 65363e96c9505cfe5d48f0904eb30cc0e26e49f2 Mon Sep 17 00:00:00 2001
From: Bruno Martins <bgcngm@gmail.com>
Date: Thu, 7 Mar 2019 23:44:30 +0000
Subject: [PATCH 5/9] common: Add missing CNE rules

Change-Id: I70bfa3bb949445476f0b1ba7514af964fb02e24e
---
 vendor/common/cnd.te             | 1 +
 vendor/common/dataservice_app.te | 2 ++
 vendor/common/hwservice.te       | 1 +
 vendor/common/hwservice_contexts | 2 ++
 vendor/common/ims.te             | 2 ++
 vendor/common/location.te        | 2 ++
 6 files changed, 10 insertions(+)

diff --git a/vendor/common/cnd.te b/vendor/common/cnd.te
index 0dfdc631..3fcf064b 100644
--- a/vendor/common/cnd.te
+++ b/vendor/common/cnd.te
@@ -93,6 +93,7 @@ allowxperm cnd self:udp_socket ioctl wlan_sock_ioctls;
 
 allow cnd sysfs_data:file r_file_perms;
 
+add_hwservice(cnd, hal_cne_hwservice)
 add_hwservice(cnd, hal_latency_hwservice)
 add_hwservice(cnd, hal_datafactory_hwservice)
 hwbinder_use(cnd)
diff --git a/vendor/common/dataservice_app.te b/vendor/common/dataservice_app.te
index 539f153d..fa3848c1 100644
--- a/vendor/common/dataservice_app.te
+++ b/vendor/common/dataservice_app.te
@@ -43,3 +43,5 @@ allow dataservice_app cnd_data_file:file r_file_perms;
 allow dataservice_app cnd_data_file:dir search;
 
 allow dataservice_app app_api_service:service_manager find;
+
+allow dataservice_app hal_cne_hwservice:hwservice_manager find;
diff --git a/vendor/common/hwservice.te b/vendor/common/hwservice.te
index 37f0c0bf..507ca04d 100644
--- a/vendor/common/hwservice.te
+++ b/vendor/common/hwservice.te
@@ -58,3 +58,4 @@ type hal_pasrmanager_hwservice, hwservice_manager_type;
 type hal_wifilearner_hwservice, hwservice_manager_type;
 type hal_seccam_hwservice, hwservice_manager_type;
 type hal_cvp_hwservice, hwservice_manager_type;
+type hal_cne_hwservice, hwservice_manager_type;
diff --git a/vendor/common/hwservice_contexts b/vendor/common/hwservice_contexts
index 09e2c0d5..7406f043 100644
--- a/vendor/common/hwservice_contexts
+++ b/vendor/common/hwservice_contexts
@@ -92,3 +92,5 @@ vendor.qti.hardware.mlshal::IMlsVnc                          u:object_r:hal_mirr
 vendor.qti.hardware.cvp::ICvp                                u:object_r:hal_cvp_hwservice:s0
 vendor.qti.hardware.wifi.wifilearner::IWifiStats             u:object_r:hal_wifilearner_hwservice:s0
 vendor.qti.hardware.seccam::ISecCam                          u:object_r:hal_seccam_hwservice:s0
+com.quicinc.cne.api::IApiService                             u:object_r:hal_cne_hwservice:s0
+com.quicinc.cne.server::IServer                              u:object_r:hal_cne_hwservice:s0
diff --git a/vendor/common/ims.te b/vendor/common/ims.te
index 7656d1da..6ea6cc85 100644
--- a/vendor/common/ims.te
+++ b/vendor/common/ims.te
@@ -63,3 +63,5 @@ get_prop(ims, qcom_ims_prop)
 get_prop(ims, cnd_vendor_prop)
 allow ims hal_datafactory_hwservice:hwservice_manager find;
 binder_call(ims, cnd)
+
+allow ims hal_cne_hwservice:hwservice_manager find;
diff --git a/vendor/common/location.te b/vendor/common/location.te
index 5b4dca70..092c933d 100644
--- a/vendor/common/location.te
+++ b/vendor/common/location.te
@@ -103,3 +103,5 @@ allow location self:capability2 wake_alarm;
 
 #allow qdma prop
 get_prop(location, vendor_qdma_prop)
+
+allow location hal_cne_hwservice:hwservice_manager find;
-- 
2.17.1

