From 03c1c22790555ed650b0b1f30515a381ec4805f2 Mon Sep 17 00:00:00 2001
From: Michael Bestas <mkbestas@lineageos.org>
Date: Wed, 6 Mar 2019 18:24:47 +0200
Subject: [PATCH 1/2] sepolicy: Label persist partition for all SoCs

Change-Id: I8db3acb9a1b958ec59c7f14c6ee16ea466548cc7
---
 msm8226/file_contexts | 1 +
 msm8909/file_contexts | 2 ++
 msm8916/file_contexts | 1 +
 msm8952/file_contexts | 2 ++
 msm8960/file_contexts | 1 +
 msm8974/file_contexts | 1 +
 msm8992/file_contexts | 1 +
 msm8994/file_contexts | 2 ++
 8 files changed, 11 insertions(+)

diff --git a/msm8226/file_contexts b/msm8226/file_contexts
index 411a79d..65ec826 100644
--- a/msm8226/file_contexts
+++ b/msm8226/file_contexts
@@ -39,5 +39,6 @@
 /dev/block/platform/msm_sdcc\.1/by-name/userdata              u:object_r:userdata_block_device:s0
 /dev/block/platform/msm_sdcc\.1/by-name/cache                 u:object_r:cache_block_device:s0
 /dev/block/platform/msm_sdcc\.1/by-name/logdump               u:object_r:logdump_partition:s0
+/dev/block/platform/msm_sdcc\.1/by-name/persist               u:object_r:persist_block_device:s0
 /dev/block/mmcblk0                                            u:object_r:root_block_device:s0
 /dev/block/mmcblk0rpmb                                        u:object_r:rpmb_device:s0
diff --git a/msm8909/file_contexts b/msm8909/file_contexts
index 0a15214..0718ca5 100644
--- a/msm8909/file_contexts
+++ b/msm8909/file_contexts
@@ -44,6 +44,7 @@
 /dev/block/platform/soc\.0/7824900\.sdhci/by-name/cache               u:object_r:cache_block_device:s0
 /dev/block/platform/soc\.0/7824900\.sdhci/by-name/boot                u:object_r:boot_block_device:s0
 /dev/block/platform/soc\.0/7824900\.sdhci/by-name/system              u:object_r:system_block_device:s0
+/dev/block/platform/soc\.0/7824900\.sdhci/by-name/persist             u:object_r:persist_block_device:s0
 /dev/block/mmcblk0                                                    u:object_r:root_block_device:s0
 /dev/block/mmcblk0rpmb                                                u:object_r:rpmb_device:s0
 
@@ -61,6 +62,7 @@
 /dev/block/platform/soc/7824900\.sdhci/by-name/boot                 u:object_r:boot_block_device:s0
 /dev/block/platform/soc/7824900\.sdhci/by-name/system               u:object_r:system_block_device:s0
 /dev/block/platform/soc/7824900\.sdhci/by-name/config               u:object_r:frp_block_device:s0
+/dev/block/platform/soc/7824900\.sdhci/by-name/persist              u:object_r:persist_block_device:s0
 
 #For adreno libs
 /(vendor|system/vendor)/lib(64)?/libsc-a3xx\.so                                     u:object_r:same_process_hal_file:s0
diff --git a/msm8916/file_contexts b/msm8916/file_contexts
index 57673b1..8451b1d 100644
--- a/msm8916/file_contexts
+++ b/msm8916/file_contexts
@@ -44,3 +44,4 @@
 /dev/block/platform/soc\.0/7824900\.sdhci/by-name/recovery            u:object_r:recovery_block_device:s0
 /dev/block/platform/soc\.0/7824900\.sdhci/by-name/system              u:object_r:system_block_device:s0
 /dev/block/platform/soc\.0/7824900\.sdhci/by-name/cache               u:object_r:cache_block_device:s0
+/dev/block/platform/soc\.0/7824900\.sdhci/by-name/persist             u:object_r:persist_block_device:s0
diff --git a/msm8952/file_contexts b/msm8952/file_contexts
index 7ae1c0d..3d2b83b 100644
--- a/msm8952/file_contexts
+++ b/msm8952/file_contexts
@@ -45,6 +45,7 @@
 /dev/block/mmcblk0rpmb                                                u:object_r:rpmb_device:s0
 /dev/block/platform/soc\.0/7824900\.sdhci/by-name/config              u:object_r:frp_block_device:s0
 /dev/block/platform/soc\.0/7824900\.sdhci/by-name/logdump             u:object_r:logdump_partition:s0
+/dev/block/platform/soc\.0/7824900\.sdhci/by-name/persist             u:object_r:persist_block_device:s0
 
 #Using soc instead of soc.0 to make it compatable with 3.18 kernel
 
@@ -62,3 +63,4 @@
 /dev/block/platform/soc/7824900\.sdhci/by-name/dip                  u:object_r:dip_device:s0
 /dev/block/platform/soc/7824900\.sdhci/by-name/mdtp                 u:object_r:mdtp_device:s0
 /dev/block/platform/soc/7824900\.sdhci/by-name/logdump              u:object_r:logdump_partition:s0
+/dev/block/platform/soc/7824900\.sdhci/by-name/persist              u:object_r:persist_block_device:s0
diff --git a/msm8960/file_contexts b/msm8960/file_contexts
index c95e3e5..0416505 100755
--- a/msm8960/file_contexts
+++ b/msm8960/file_contexts
@@ -19,6 +19,7 @@
 /dev/block/platform/msm_sdcc\.1/by-name/cache    u:object_r:cache_block_device:s0
 /dev/block/platform/msm_sdcc\.1/by-name/system   u:object_r:system_block_device:s0
 /dev/block/platform/msm_sdcc\.1/by-name/logdump  u:object_r:logdump_partition:s0
+/dev/block/platform/msm_sdcc\.1/by-name/persist  u:object_r:persist_block_device:s0
 /dev/block/mmcblk0                              u:object_r:root_block_device:s0
 /dev/socket/mpdecision                          u:object_r:mpdecision_socket:s0
 ###################################
diff --git a/msm8974/file_contexts b/msm8974/file_contexts
index 6139b5e..12e400b 100644
--- a/msm8974/file_contexts
+++ b/msm8974/file_contexts
@@ -39,5 +39,6 @@
 /dev/block/platform/msm_sdcc\.1/by-name/userdata              u:object_r:userdata_block_device:s0
 /dev/block/platform/msm_sdcc\.1/by-name/cache                 u:object_r:cache_block_device:s0
 /dev/block/platform/msm_sdcc\.1/by-name/logdump               u:object_r:logdump_partition:s0
+/dev/block/platform/msm_sdcc\.1/by-name/persist               u:object_r:persist_block_device:s0
 /dev/block/mmcblk0                                            u:object_r:root_block_device:s0
 /dev/block/mmcblk0rpmb                                        u:object_r:rpmb_device:s0
diff --git a/msm8992/file_contexts b/msm8992/file_contexts
index 00fbce2..602f52a 100644
--- a/msm8992/file_contexts
+++ b/msm8992/file_contexts
@@ -39,5 +39,6 @@
 /dev/block/platform/soc\.0/f9824900\.sdhci/by-name/cache                            u:object_r:cache_block_device:s0
 /dev/block/platform/soc\.0/f9824900\.sdhci/by-name/config                           u:object_r:frp_block_device:s0
 /dev/block/platform/soc\.0/f9824900\.sdhci/by-name/logdump                          u:object_r:logdump_partition:s0
+/dev/block/platform/soc\.0/f9824900\.sdhci/by-name/persist                          u:object_r:persist_block_device:s0
 /dev/block/mmcblk0rpmb                                                              u:object_r:rpmb_device:s0
 /dev/block/mmcblk0                                                                  u:object_r:root_block_device:s0
diff --git a/msm8994/file_contexts b/msm8994/file_contexts
index 436b659..2209f49 100644
--- a/msm8994/file_contexts
+++ b/msm8994/file_contexts
@@ -44,6 +44,7 @@
 /dev/block/platform/soc\.0/fc594000\.ufshc/by-name/cache                            u:object_r:cache_block_device:s0
 /dev/block/platform/soc\.0/fc594000\.ufshc/by-name/frp                              u:object_r:frp_block_device:s0
 /dev/block/platform/soc\.0/fc594000\.ufshc/by-name/logdump                          u:object_r:logdump_partition:s0
+/dev/block/platform/soc\.0/fc594000\.sdhci/by-name/persist                          u:object_r:persist_block_device:s0
 
 
 # eMMC devices
@@ -59,3 +60,4 @@
 /dev/block/platform/soc\.0/f9824900\.sdhci/by-name/cache                            u:object_r:cache_block_device:s0
 /dev/block/platform/soc\.0/f9824900\.sdhci/by-name/config                           u:object_r:frp_block_device:s0
 /dev/block/platform/soc\.0/f9824900\.sdhci/by-name/logdump                          u:object_r:logdump_partition:s0
+/dev/block/platform/soc\.0/f9824900\.sdhci/by-name/persist                          u:object_r:persist_block_device:s0
-- 
2.17.1

