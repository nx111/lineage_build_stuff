From fe9a842ebacfc4bd475301dbf8591e35b9bf72ad Mon Sep 17 00:00:00 2001
From: Paul Keith <javelinanddart@gmail.com>
Date: Wed, 13 Feb 2019 11:26:26 -0600
Subject: [PATCH 2/2] legacymm: Forcefully restore default display mode

* It seems the some legacymm devices need this too

Change-Id: If4641b255bceb1228387571c27b4fe994d2f8540
---
 legacymm/DisplayModes.cpp | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/legacymm/DisplayModes.cpp b/legacymm/DisplayModes.cpp
index bc9e2cb..3eca734 100644
--- a/legacymm/DisplayModes.cpp
+++ b/legacymm/DisplayModes.cpp
@@ -43,6 +43,13 @@ DisplayModes::DisplayModes(void* libHandle) {
         dlsym(mLibHandle, "disp_api_get_default_display_mode"));
     disp_api_set_default_display_mode = reinterpret_cast<int (*)(int32_t, int)>(
         dlsym(mLibHandle, "disp_api_set_default_display_mode"));
+
+    if (isSupported()) {
+        DisplayMode mode = getDefaultDisplayModeInternal();
+        if (mode.id >= 0) {
+            setDisplayMode(mode.id, false);
+        }
+    }
 }
 
 bool DisplayModes::isSupported() {
-- 
2.17.1

