From 39bac726240321820241404189ff751e3a4bc063 Mon Sep 17 00:00:00 2001
From: Bruno Martins <bgcngm@gmail.com>
Date: Mon, 3 Jun 2019 23:34:05 +0100
Subject: [PATCH 28/38] BatteryMeterDrawableBase: Set proper stroke when power
 saver is enabled

Change-Id: I371819a97aae849d842d199ead54a333df50d1bf
---
 .../settingslib/graph/BatteryMeterDrawableBase.java        | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

diff --git a/packages/SettingsLib/src/com/android/settingslib/graph/BatteryMeterDrawableBase.java b/packages/SettingsLib/src/com/android/settingslib/graph/BatteryMeterDrawableBase.java
index 80c7f65e58a..ce4c0a59512 100644
--- a/packages/SettingsLib/src/com/android/settingslib/graph/BatteryMeterDrawableBase.java
+++ b/packages/SettingsLib/src/com/android/settingslib/graph/BatteryMeterDrawableBase.java
@@ -169,8 +169,6 @@ public class BatteryMeterDrawableBase extends Drawable {
         mPowersavePaint = new Paint(Paint.ANTI_ALIAS_FLAG);
         mPowersavePaint.setColor(mPlusPaint.getColor());
         mPowersavePaint.setStyle(Style.STROKE);
-        mPowersavePaint.setStrokeWidth(context.getResources()
-                .getDimensionPixelSize(R.dimen.battery_powersave_outline_thickness));
 
         mIntrinsicWidth = context.getResources().getDimensionPixelSize(R.dimen.battery_width);
         mIntrinsicHeight = context.getResources().getDimensionPixelSize(R.dimen.battery_height);
@@ -342,6 +340,8 @@ public class BatteryMeterDrawableBase extends Drawable {
         mBatteryPaint.setStrokeWidth(strokeWidth);
         mBatteryPaint.setStyle(Paint.Style.STROKE);
 
+        mPowersavePaint.setStrokeWidth(strokeWidth);
+
         mFrame.set(
                 strokeWidth / 2.0f + mPadding.left,
                 strokeWidth / 2.0f,
@@ -427,6 +427,9 @@ public class BatteryMeterDrawableBase extends Drawable {
         mBatteryPaint.setStrokeWidth(0);
         mBatteryPaint.setStyle(Paint.Style.FILL_AND_STROKE);
 
+        mPowersavePaint.setStrokeWidth(mContext.getResources()
+                .getDimensionPixelSize(R.dimen.battery_powersave_outline_thickness));
+
         mFrame.set(left, top, width + left, height + top);
         mFrame.offset(px, 0);
 
-- 
2.17.1

