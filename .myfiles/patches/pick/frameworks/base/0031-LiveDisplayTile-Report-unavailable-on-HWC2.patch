From cbd782dd8ec6fe320b4255d14924df9f305d5fb6 Mon Sep 17 00:00:00 2001
From: Han Wang <416810799@qq.com>
Date: Tue, 4 Jun 2019 18:03:59 +0200
Subject: [PATCH 31/40] LiveDisplayTile: Report unavailable on HWC2

Change-Id: Ic10381e25046a2338bc6bda36ecbb5d5cefc1ab8
---
 .../com/android/systemui/qs/tiles/LiveDisplayTile.java    | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/packages/SystemUI/src/com/android/systemui/qs/tiles/LiveDisplayTile.java b/packages/SystemUI/src/com/android/systemui/qs/tiles/LiveDisplayTile.java
index 17412924c36..db8fecf2b4a 100644
--- a/packages/SystemUI/src/com/android/systemui/qs/tiles/LiveDisplayTile.java
+++ b/packages/SystemUI/src/com/android/systemui/qs/tiles/LiveDisplayTile.java
@@ -1,6 +1,6 @@
 /*
  * Copyright (C) 2015 The CyanogenMod Project
- * Copyright (C) 2018 The LineageOS Project
+ * Copyright (C) 2018-2019 The LineageOS Project
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
@@ -32,6 +32,7 @@ import android.os.UserHandle;
 import android.provider.Settings;
 import android.service.quicksettings.Tile;
 
+import com.android.internal.app.ColorDisplayController;
 import com.android.internal.util.ArrayUtils;
 import com.android.systemui.plugins.qs.QSTile.LiveDisplayState;
 import com.android.systemui.qs.QSHost;
@@ -103,6 +104,11 @@ public class LiveDisplayTile extends QSTileImpl<LiveDisplayState> {
         mValues = res.getStringArray(R.array.live_display_values);
     }
 
+    @Override
+    public boolean isAvailable() {
+        return !ColorDisplayController.isAvailable(mContext);
+    }
+
     @Override
     public LiveDisplayState newTileState() {
         return new LiveDisplayState();
-- 
2.17.1

