From 045fb4c85836696e09e9e4d52e4ac699e69bf234 Mon Sep 17 00:00:00 2001
From: Hendrik Hagendorn <finnq@lineageos.org>
Date: Sun, 15 Jan 2017 08:31:13 +0100
Subject: [PATCH 4/4] LineageParts: Bring back and refactor battery icon
 options

* Use the icon blacklist for hiding
* Combine options for hiding status bar icons in system tuner settings

Change-Id: Id8c6df982192cfb54350c9cfe8d8ca4983dd7972
---
 res/values/arrays.xml                                |  6 +-----
 res/values/strings.xml                               |  2 --
 res/xml/status_bar_settings.xml                      |  4 +---
 .../lineageparts/statusbar/StatusBarSettings.java    | 12 +++---------
 4 files changed, 5 insertions(+), 19 deletions(-)

diff --git a/res/values/arrays.xml b/res/values/arrays.xml
index bcdc7eb..762b4c4 100644
--- a/res/values/arrays.xml
+++ b/res/values/arrays.xml
@@ -268,18 +268,14 @@
 
     <string-array name="status_bar_battery_style_entries" translatable="false">
         <item>@string/status_bar_battery_style_icon_portrait</item>
-        <item>@string/status_bar_battery_style_icon_landscape</item>
         <item>@string/status_bar_battery_style_circle</item>
         <item>@string/status_bar_battery_style_text</item>
-        <item>@string/status_bar_battery_style_hidden</item>
     </string-array>
 
     <string-array name="status_bar_battery_style_values" translatable="false">
         <item>0</item>
-        <item>5</item>
+        <item>1</item>
         <item>2</item>
-        <item>6</item>
-        <item>4</item>
     </string-array>
 
     <string-array name="status_bar_battery_percentage_entries" translatable="false">
diff --git a/res/values/strings.xml b/res/values/strings.xml
index a844d20..a8cafd6 100644
--- a/res/values/strings.xml
+++ b/res/values/strings.xml
@@ -486,10 +486,8 @@
     <string name="status_bar_battery_title">Battery indicator</string>
     <string name="status_bar_battery_style_title">Battery status style</string>
     <string name="status_bar_battery_style_icon_portrait">Icon portrait</string>
-    <string name="status_bar_battery_style_icon_landscape">Icon landscape</string>
     <string name="status_bar_battery_style_circle">Circle</string>
     <string name="status_bar_battery_style_text">Text</string>
-    <string name="status_bar_battery_style_hidden">Hidden</string>
 
     <!-- Status bar - Battery percentage -->
     <string name="status_bar_battery_percentage_title">Battery percentage</string>
diff --git a/res/xml/status_bar_settings.xml b/res/xml/status_bar_settings.xml
index 85e76be..5364075 100644
--- a/res/xml/status_bar_settings.xml
+++ b/res/xml/status_bar_settings.xml
@@ -83,7 +83,6 @@
             android:defaultValue="2" />
     </PreferenceCategory>
 
-<!--
     <PreferenceCategory
         android:key="status_bar_battery_key"
         android:title="@string/status_bar_battery_title">
@@ -95,7 +94,7 @@
             android:dialogTitle="@string/status_bar_battery_style_title"
             android:entries="@array/status_bar_battery_style_entries"
             android:entryValues="@array/status_bar_battery_style_values"
-            android:defaultValue="2" />
+            android:defaultValue="0" />
 
         <lineageos.preference.LineageSystemSettingListPreference
             android:key="status_bar_show_battery_percent"
@@ -107,7 +106,6 @@
             android:defaultValue="0" />
 
     </PreferenceCategory>
--->
 
     <PreferenceCategory
         android:title="@string/status_bar_brightness_category">
diff --git a/src/org/lineageos/lineageparts/statusbar/StatusBarSettings.java b/src/org/lineageos/lineageparts/statusbar/StatusBarSettings.java
index 400028f..45d8e75 100644
--- a/src/org/lineageos/lineageparts/statusbar/StatusBarSettings.java
+++ b/src/org/lineageos/lineageparts/statusbar/StatusBarSettings.java
@@ -52,8 +52,8 @@ public class StatusBarSettings extends SettingsPreferenceFragment
     private static final String STATUS_BAR_SHOW_BATTERY_PERCENT = "status_bar_show_battery_percent";
     private static final String STATUS_BAR_QUICK_QS_PULLDOWN = "qs_quick_pulldown";
 
-    private static final int STATUS_BAR_BATTERY_STYLE_HIDDEN = 4;
-    private static final int STATUS_BAR_BATTERY_STYLE_TEXT = 6;
+    private static final int STATUS_BAR_BATTERY_STYLE_TEXT = 2;
+
     private static final int PULLDOWN_DIR_NONE = 0;
     private static final int PULLDOWN_DIR_RIGHT = 1;
     private static final int PULLDOWN_DIR_LEFT = 2;
@@ -95,14 +95,12 @@ public class StatusBarSettings extends SettingsPreferenceFragment
         mStatusBarClockCategory =
                 (PreferenceCategory) getPreferenceScreen().findPreference(CATEGORY_CLOCK);
 
-/*
         mStatusBarBatteryShowPercent =
                 (LineageSystemSettingListPreference) findPreference(STATUS_BAR_SHOW_BATTERY_PERCENT);
         mStatusBarBattery =
                 (LineageSystemSettingListPreference) findPreference(STATUS_BAR_BATTERY_STYLE);
         mStatusBarBattery.setOnPreferenceChangeListener(this);
         enableStatusBarBatteryDependents(mStatusBarBattery.getIntValue(2));
-*/
 
         mStatusBarBatteryCategory =
                 (PreferenceCategory) getPreferenceScreen().findPreference(CATEGORY_BATTERY);
@@ -173,19 +171,15 @@ public class StatusBarSettings extends SettingsPreferenceFragment
             case STATUS_BAR_CLOCK_STYLE:
                 updateNetworkTrafficStatus(value);
                 break;
-/*
             case STATUS_BAR_BATTERY_STYLE:
                 enableStatusBarBatteryDependents(value);
                 break;
-*/
         }
         return true;
     }
 
     private void enableStatusBarBatteryDependents(int batteryIconStyle) {
-        mStatusBarBatteryShowPercent.setEnabled(
-                batteryIconStyle != STATUS_BAR_BATTERY_STYLE_HIDDEN
-                && batteryIconStyle != STATUS_BAR_BATTERY_STYLE_TEXT);
+        mStatusBarBatteryShowPercent.setEnabled(batteryIconStyle != STATUS_BAR_BATTERY_STYLE_TEXT);
     }
 
     private void updateQuickPulldownSummary(int value) {
-- 
2.17.1

