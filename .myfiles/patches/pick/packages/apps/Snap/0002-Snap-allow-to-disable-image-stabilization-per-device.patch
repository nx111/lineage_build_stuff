From 2b92a572566cbf318048d92fdc89990ef0798b77 Mon Sep 17 00:00:00 2001
From: codeworkx <daniel.hillenbrand@codeworkx.de>
Date: Sun, 3 Mar 2019 18:13:21 +0100
Subject: [PATCH 2/2] Snap: allow to disable image stabilization per device

Change-Id: I4317f84285bdf97ba321ad5ddba7453f2b5d3b0c
---
 res/values/config.xml                      | 3 +++
 src/com/android/camera/CameraSettings.java | 6 ++++++
 2 files changed, 9 insertions(+)

diff --git a/res/values/config.xml b/res/values/config.xml
index 342105349..cb78e532c 100644
--- a/res/values/config.xml
+++ b/res/values/config.xml
@@ -74,6 +74,9 @@
     <!-- Minimum picture size (in pixel) to include in selection list -->
     <integer name="minimum_picture_size">900000</integer>
 
+    <!-- Enable support for image stabilization -->
+    <bool name="support_dis">true</bool>
+
     <!-- Enable support for bokeh mode -->
     <bool name="support_bokeh_mode">false</bool>
 </resources>
diff --git a/src/com/android/camera/CameraSettings.java b/src/com/android/camera/CameraSettings.java
index ab4b1a6a4..107777eba 100755
--- a/src/com/android/camera/CameraSettings.java
+++ b/src/com/android/camera/CameraSettings.java
@@ -301,6 +301,7 @@ public class CameraSettings {
     public static String mKeyIso = null;
     public static String mKeyIsoValues = null;
 
+    private static boolean mSupportDis = false;
     private static boolean mSupportBokehMode = false;
 
     private static final HashMap<Integer, String>
@@ -473,6 +474,9 @@ public class CameraSettings {
             Log.d(TAG, "Using key for iso-values: " + mKeyIsoValues);
         }
 
+        // Image stabilization
+        mSupportDis = mContext.getResources().getBoolean(R.bool.support_dis);
+
         // Bokeh mode
         mSupportBokehMode = mContext.getResources().getBoolean(R.bool.support_bokeh_mode);
     }
@@ -613,6 +617,8 @@ public class CameraSettings {
     }
 
     public static List<String> getSupportedDISModes(Parameters params) {
+        if (!mSupportDis)
+            return null;
         String str = params.get(KEY_QC_SUPPORTED_DIS_MODES);
         if (str == null) {
             return null;
-- 
2.17.1

