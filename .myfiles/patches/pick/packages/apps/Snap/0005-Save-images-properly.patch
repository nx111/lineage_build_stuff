From d884889b8f54e042c94b552ee9e79ad1f34fef28 Mon Sep 17 00:00:00 2001
From: Luca Stefani <luca.stefani.ge1@gmail.com>
Date: Mon, 20 May 2019 18:40:02 +0200
Subject: [PATCH 5/6] Save images properly

Change-Id: I8f9b6d870f16238be41b228873b82f2e89e86b00

# Conflicts:
#	src/com/android/camera/SDCard.java
---
 src/com/android/camera/SDCard.java | 25 +++----------------------
 1 file changed, 3 insertions(+), 22 deletions(-)

diff --git a/src/com/android/camera/SDCard.java b/src/com/android/camera/SDCard.java
index b88e32245..2e3c34ef0 100644
--- a/src/com/android/camera/SDCard.java
+++ b/src/com/android/camera/SDCard.java
@@ -45,12 +45,10 @@ public class SDCard {
     private StorageManager mStorageManager = null;
     private StorageVolume mVolume = null;
     private String mPath = null;
-    private String mRawpath = null;
     private static SDCard sSDCard;
 
     public boolean isWriteable() {
-        if (mVolume == null) return false;
-        final String state = getSDCardStorageState();
+        String state = Environment.getExternalStorageState();
         if (Environment.MEDIA_MOUNTED.equals(state)) {
             return true;
         }
@@ -67,16 +65,6 @@ public class SDCard {
         return mPath;
     }
 
-    public String getRawDirectory() {
-        if (mVolume == null) {
-            return null;
-        }
-        if (mRawpath == null) {
-            mRawpath = mVolume.getPath() + "/DCIM/Camera/raw";
-        }
-        return mRawpath;
-    }
-
     public static void initialize(Context context) {
         if (sSDCard == null) {
             sSDCard = new SDCard(context);
@@ -87,10 +75,6 @@ public class SDCard {
         return sSDCard;
     }
 
-    private String getSDCardStorageState() {
-        return mVolume.getState();
-    }
-
     private SDCard(Context context) {
         try {
             mStorageManager = (StorageManager) context.getSystemService(Context.STORAGE_SERVICE);
@@ -102,11 +86,8 @@ public class SDCard {
     }
 
     private void initVolume() {
-        final StorageVolume[] volumes = mStorageManager.getVolumeList();
-        mVolume = (volumes.length > VOLUME_SDCARD_INDEX) ?
-                volumes[VOLUME_SDCARD_INDEX] : null;
-        mPath = null;
-        mRawpath = null;
+        mPath = Environment.getExternalStoragePublicDirectory(
+                Environment.DIRECTORY_DCIM).toString();
     }
 
     private void registerMediaBroadcastreceiver(Context context) {
-- 
2.17.1

