From 9e4f39b880bebc83874347c6b64dba9e698a6706 Mon Sep 17 00:00:00 2001
From: jinwu <jinwu@codeaurora.org>
Date: Thu, 27 Dec 2018 17:35:51 +0800
Subject: [PATCH 7/8] change to BUILD_NUMBER_FROM_FILE

Change-Id: Ic21f10e0568dc7637da676d6fa40e9062e4af6e9
---
 version.mk | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/version.mk b/version.mk
index ae04a1a52..bf9ff6367 100755
--- a/version.mk
+++ b/version.mk
@@ -45,7 +45,7 @@ base_version_build := 015
 #####################################################
 #####################################################
 # Collect automatic version code parameters
-ifneq "" "$(filter eng.%,$(BUILD_NUMBER))"
+ifneq "" "$(filter eng.%,$(BUILD_NUMBER_FROM_FILE))"
   # This is an eng build
   base_version_buildtype := 0
 else
@@ -84,8 +84,8 @@ version_code_package := $(base_version_major)$(base_version_minor)$(base_version
 # - For eng build (t=0):     M.m.bbb eng.$(USER)-hh
 # - For build server (t=1):  M.m.bbb (nnnnnn-hh)
 #       where nnnnnn is the build number from the build server (no zero-padding)
-# On eng builds, the BUILD_NUMBER has the user and timestamp inline
-ifneq "" "$(filter eng.%,$(BUILD_NUMBER))"
+# On eng builds, the BUILD_NUMBER_FROM_FILE has the user and timestamp inline
+ifneq "" "$(filter eng.%,$(BUILD_NUMBER_FROM_FILE))"
   git_hash := $(shell git --git-dir $(LOCAL_PATH)/.git log -n 1 --pretty=format:%h)
   date_string := $$(date +%m%d%y_%H%M%S)
   version_name_package := $(base_version_major).$(base_version_minor).$(base_version_build) (eng.$(USER).$(git_hash).$(date_string)-$(base_version_arch)$(base_version_density))
-- 
2.17.1

