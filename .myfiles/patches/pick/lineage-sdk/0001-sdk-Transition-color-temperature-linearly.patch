From 9174bac3bc27752b658e5bcb433c46d721462675 Mon Sep 17 00:00:00 2001
From: Paul Keith <javelinanddart@gmail.com>
Date: Sun, 17 Feb 2019 04:05:42 +0100
Subject: [PATCH 1/4] sdk: Transition color temperature linearly

* The quadratic transition can lead to weird jumps

Change-Id: I02f10b00f44c782d133c82f400e75495ba59e84d
---
 .../platform/internal/display/ColorTemperatureController.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/lineage/lib/main/java/org/lineageos/platform/internal/display/ColorTemperatureController.java b/lineage/lib/main/java/org/lineageos/platform/internal/display/ColorTemperatureController.java
index 40bc681..f0c90d0 100644
--- a/lineage/lib/main/java/org/lineageos/platform/internal/display/ColorTemperatureController.java
+++ b/lineage/lib/main/java/org/lineageos/platform/internal/display/ColorTemperatureController.java
@@ -325,8 +325,8 @@ public class ColorTemperatureController extends LiveDisplayFeature {
 
         if (twilight != null) {
             final long now = System.currentTimeMillis();
-            adjustment = adj(now, twilight.getYesterdaySunset(), twilight.getTodaySunrise()) *
-                    adj(now, twilight.getTodaySunset(), twilight.getTomorrowSunrise());
+            adjustment = (adj(now, twilight.getYesterdaySunset(), twilight.getTodaySunrise()) +
+                    adj(now, twilight.getTodaySunset(), twilight.getTomorrowSunrise())) / 2;
         }
 
         return (int)MathUtils.lerp(mNightTemperature, mDayTemperature, adjustment);
-- 
2.17.1

