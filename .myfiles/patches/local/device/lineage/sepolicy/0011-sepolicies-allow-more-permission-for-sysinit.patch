From dd6b7ac5be37022d8b407cb2a264f683a6832016 Mon Sep 17 00:00:00 2001
From: nx111 <NX111.AimH@gmail.com>
Date: Sun, 10 Feb 2019 14:53:19 +0800
Subject: [PATCH 11/11] sepolicies: allow more permission for sysinit.

Change-Id: I13e9bcd9637dbdaa6337d74ec64288b1ca813d4b
---
 common/private/sysinit.te | 27 +++++++++++++++++++++++++++
 1 file changed, 27 insertions(+)

diff --git a/common/private/sysinit.te b/common/private/sysinit.te
index 7a584d5..ce49f41 100644
--- a/common/private/sysinit.te
+++ b/common/private/sysinit.te
@@ -8,3 +8,30 @@ neverallow { domain -init } sysinit:process transition;
 userdebug_or_eng(`
     permissive sysinit;
 ')
+
+allow sysinit shell_exec:file {
+    execute
+    getattr
+    read
+    open
+};
+
+allow sysinit toolbox_exec:file {
+    execute
+    execute_no_trans
+    getattr
+    open
+    read
+};
+
+allow sysinit system_file:file {
+    execute_no_trans
+    open
+    read
+};
+
+allow sysinit system_file:dir {
+    open
+    read
+};
+
-- 
2.17.1

